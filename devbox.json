{
  "env": {
    "DEVBOX_SHARE_DIR": "$PWD/.devbox/nix/profile/default/share",
    "NETSKOPE_CERT_PATH": "/Library/Application Support/Netskope/STAgent/data/nscacert.pem"
  },
  "packages": [
    "bats@latest",
    "bats.libraries.bats-assert",
    "bats.libraries.bats-support"
  ],
  "shell": {
    "scripts": {
      "test": [
        "devbox run test-bash",
        "devbox run test-zsh",
        "devbox run test-fish"
      ],
      "test-bash" : [
        "devbox run build-test-image",
        "docker run bootstrap-script-test bats test/bootstrap-agnostic.bats test/bootstrap-bash.bats"
      ],
      "test-zsh" :[
        "devbox run build-test-image",
        "docker run bootstrap-script-test bats test/bootstrap-agnostic.bats test/bootstrap-zsh.bats"
      ],
      "test-fish" :[
        "devbox run build-test-image",
        "docker run bootstrap-script-test bats test/bootstrap-agnostic.bats test/bootstrap-fish.bats"
      ],
      "build-test-image" : [
        "docker build -t bootstrap-script-test --build-arg NETSKOPE_CERT=\"$(cat \"$NETSKOPE_CERT_PATH\")\" -f ./bootstrap-test.Dockerfile .",
      ]
    }
  }
}
